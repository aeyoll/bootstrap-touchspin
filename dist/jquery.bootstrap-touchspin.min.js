/*
 *  Bootstrap Touchspin - v4.7.0
 *  A mobile and touch friendly input spinner component for Bootstrap 3 & 4.
 *  https://www.virtuosoft.eu/code/bootstrap-touchspin/
 *
 *  Made by István Ujj-Mészáros
 *  Under MIT License
 */
!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(t,o){return void 0===o&&(o="undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(o),o}:n(jQuery)}(function(S){"use strict";var T=0;S.fn.TouchSpin=function(N){var q={min:0,max:100,initval:"",replacementval:"",firstclickvalueifempty:null,step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalup:"&plus;",verticaldown:"&minus;",verticalupclass:"",verticaldownclass:"",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-primary",buttonup_class:"btn btn-primary",buttondown_txt:"&minus;",buttonup_txt:"&plus;",callback_before_calculation:function(t){return t},callback_after_calculation:function(t){return t}},B={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",firstclickvalueifempty:"first-click-value-if-empty",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){var s,a,e,p,t,n,o,i,u,r,c,l,d,f,b,h,v,m=S(this),x=m.data(),g=0,w=!1;function y(){""===s.prefix&&(a=p.prefix.detach()),""===s.postfix&&(e=p.postfix.detach())}function _(){var t,o,n=s.callback_before_calculation(m.val());""===n?""!==s.replacementval&&(m.val(s.replacementval),m.trigger("change")):0<s.decimals&&"."===n||(t=parseFloat(n),(o=t=isNaN(t)?""!==s.replacementval?s.replacementval:0:t).toString()!==n&&(o=t),o=function(t){switch(s.forcestepdivisibility){case"round":return(Math.round(t/s.step)*s.step).toFixed(s.decimals);case"floor":return(Math.floor(t/s.step)*s.step).toFixed(s.decimals);case"ceil":return(Math.ceil(t/s.step)*s.step).toFixed(s.decimals);default:return t.toFixed(s.decimals)}}(t),null!==s.min&&t<s.min&&(o=s.min),null!==s.max&&t>s.max&&(o=s.max),parseFloat(t).toString()!==parseFloat(o).toString()&&m.val(o),m.val(s.callback_after_calculation(parseFloat(o).toFixed(s.decimals))))}function k(){var t;return s.booster?(t=Math.pow(2,Math.floor(g/s.boostat))*s.step,s.maxboostedstep&&t>s.maxboostedstep&&(t=s.maxboostedstep,n=Math.round(n/t)*t),Math.max(s.step,t)):s.step}function C(){return"number"==typeof s.firstclickvalueifempty?s.firstclickvalueifempty:(s.min+s.max)/2}function $(){var t=m.is(":disabled,[readonly]");p.up.prop("disabled",t),p.down.prop("disabled",t),t&&P()}function F(){var t,o;m.is(":disabled,[readonly]")||(_(),t=n=parseFloat(s.callback_before_calculation(p.input.val())),isNaN(n)?n=C():(o=k(),n+=o),null!==s.max&&n>s.max&&(n=s.max,m.trigger("touchspin.on.max"),P()),p.input.val(s.callback_after_calculation(parseFloat(n).toFixed(s.decimals))),t!==n&&m.trigger("change"))}function j(){var t,o;m.is(":disabled,[readonly]")||(_(),t=n=parseFloat(s.callback_before_calculation(p.input.val())),isNaN(n)?n=C():(o=k(),n-=o),null!==s.min&&n<s.min&&(n=s.min,m.trigger("touchspin.on.min"),P()),p.input.val(s.callback_after_calculation(parseFloat(n).toFixed(s.decimals))),t!==n&&m.trigger("change"))}function D(){m.is(":disabled,[readonly]")||(P(),g=0,w="down",m.trigger("touchspin.on.startspin"),m.trigger("touchspin.on.startdownspin"),u=setTimeout(function(){o=setInterval(function(){g++,j()},s.stepinterval)},s.stepintervaldelay))}function M(){m.is(":disabled,[readonly]")||(P(),g=0,w="up",m.trigger("touchspin.on.startspin"),m.trigger("touchspin.on.startupspin"),r=setTimeout(function(){i=setInterval(function(){g++,F()},s.stepinterval)},s.stepintervaldelay))}function P(){switch(clearTimeout(u),clearTimeout(r),clearInterval(o),clearInterval(i),w){case"up":m.trigger("touchspin.on.stopupspin"),m.trigger("touchspin.on.stopspin");break;case"down":m.trigger("touchspin.on.stopdownspin"),m.trigger("touchspin.on.stopspin")}g=0,w=!1}m.data("alreadyinitialized")||(m.data("alreadyinitialized",!0),T+=1,m.data("spinnerid",T),m.is("input")?(s=S.extend({},q,x,function(){var n={};return S.each(B,function(t,o){o="bts-"+o;m.is("[data-"+o+"]")&&(n[t]=m.data(o))}),S.each(["min","max","step"],function(t,o){m.is("["+o+"]")&&(void 0!==n[o]&&console.warn('Both the "data-bts-'+o+'" data attribute and the "'+o+'" individual attribute were specified, the individual attribute will take precedence on: ',m),n[o]=m.attr(o))}),n}(),N),1!==parseFloat(s.step)&&(0!=(c=s.max%s.step)&&(s.max=parseFloat(s.max)-c),0!=(c=s.min%s.step))&&(s.min=parseFloat(s.min)+(parseFloat(s.step)-c)),""!==s.initval&&""===m.val()&&m.val(s.initval),_(),c=m.val(),x=m.parent(),""!==c&&(c=s.callback_before_calculation(c),c=s.callback_after_calculation(parseFloat(c).toFixed(s.decimals))),m.data("initvalue",c).val(c),m.addClass("form-control"),t=`
          <span class="input-group-addon bootstrap-touchspin-vertical-button-wrapper">
            <span class="input-group-btn-vertical">
              <button class="${s.buttondown_class} bootstrap-touchspin-up ${s.verticalupclass}" type="button">${s.verticalup}</button>
              <button class="${s.buttonup_class} bootstrap-touchspin-down ${s.verticaldownclass}" type="button">${s.verticaldown}</button>
            </span>
          </span>
       `,x.hasClass("input-group")?((x=x).addClass("bootstrap-touchspin"),v=m.prev(),f=m.next(),b=`
            <span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix input-group-prepend bootstrap-touchspin-injected">
              <span class="input-group-text">${s.prefix}</span>
            </span>
          `,h=`
            <span class="input-group-addon input-group-append bootstrap-touchspin-postfix input-group-append bootstrap-touchspin-injected">
              <span class="input-group-text">${s.postfix}</span>
            </span>
          `,s.verticalbuttons?S(t).insertAfter(m):(v.hasClass("input-group-btn")||v.hasClass("input-group-prepend")?(l=`
              <button class="${s.buttondown_class} bootstrap-touchspin-down bootstrap-touchspin-injected" type="button">${s.buttondown_txt}</button>
            `,v.append(l)):(l=`
              <span class="input-group-btn input-group-prepend bootstrap-touchspin-injected">
                <button class="${s.buttondown_class} bootstrap-touchspin-down" type="button">${s.buttondown_txt}</button>
              </span>
            `,S(l).insertBefore(m)),f.hasClass("input-group-btn")||f.hasClass("input-group-append")?(d=`
            <button class="${s.buttonup_class} bootstrap-touchspin-up bootstrap-touchspin-injected" type="button">${s.buttonup_txt}</button>
          `,f.prepend(d)):(d=`
            <span class="input-group-btn input-group-append bootstrap-touchspin-injected">
              <button class="${s.buttonup_class} bootstrap-touchspin-up" type="button">${s.buttonup_txt}</button>
            </span>
          `,S(d).insertAfter(m))),S(b).insertBefore(m),S(h).insertAfter(m),l=x):(v="",m.hasClass("input-sm")||m.hasClass("form-control-sm")?v="input-group-sm":(m.hasClass("input-lg")||m.hasClass("form-control-lg"))&&(v="input-group-lg"),v=s.verticalbuttons?`
            <div class="input-group ${v} bootstrap-touchspin bootstrap-touchspin-injected">
              <span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix">
                <span class="input-group-text">${s.prefix}</span>
              </span>
              <span class="input-group-addon bootstrap-touchspin-postfix input-group-append">
                <span class="input-group-text">${s.postfix}</span>
              </span>
              ${t}
            </div>
          `:`
            <div class="input-group bootstrap-touchspin bootstrap-touchspin-injected">
              <span class="input-group-btn input-group-prepend">
                <button class="${s.buttondown_class} bootstrap-touchspin-down" type="button">${s.buttondown_txt}</button>
              </span>
              <span class="input-group-addon bootstrap-touchspin-prefix input-group-prepend">
                <span class="input-group-text">${s.prefix}</span>
              </span>
              <span class="input-group-addon bootstrap-touchspin-postfix input-group-append">
                <span class="input-group-text">${s.postfix}</span>
              </span>
              <span class="input-group-btn input-group-append">
                <button class="${s.buttonup_class} bootstrap-touchspin-up" type="button">${s.buttonup_txt}</button>
              </span>
            </div>`,l=S(v).insertBefore(m),S(".bootstrap-touchspin-prefix",l).after(m),m.hasClass("input-sm")||m.hasClass("form-control-sm")?l.addClass("input-group-sm"):(m.hasClass("input-lg")||m.hasClass("form-control-lg"))&&l.addClass("input-group-lg")),p={down:S(".bootstrap-touchspin-down",l),up:S(".bootstrap-touchspin-up",l),input:S("input",l),prefix:S(".bootstrap-touchspin-prefix",l).addClass(s.prefix_extraclass),postfix:S(".bootstrap-touchspin-postfix",l).addClass(s.postfix_extraclass)},$(),y(),"undefined"!=typeof MutationObserver&&new MutationObserver(t=>{t.forEach(t=>{"attributes"!==t.type||"disabled"!==t.attributeName&&"readonly"!==t.attributeName||$()})}).observe(m[0],{attributes:!0}),m.on("keydown.touchspin",function(t){var o=t.keyCode||t.which;38===o?("up"!==w&&(F(),M()),t.preventDefault()):40===o?("down"!==w&&(j(),D()),t.preventDefault()):9!==o&&13!==o||_()}),m.on("keyup.touchspin",function(t){t=t.keyCode||t.which;38!==t&&40!==t||P()}),S(document).on("mousedown touchstart",function(t){S(t.target).is(m)||_()}),m.on("blur.touchspin",function(){_()}),p.down.on("keydown",function(t){var o=t.keyCode||t.which;32!==o&&13!==o||("down"!==w&&(j(),D()),t.preventDefault())}),p.down.on("keyup.touchspin",function(t){t=t.keyCode||t.which;32!==t&&13!==t||P()}),p.up.on("keydown.touchspin",function(t){var o=t.keyCode||t.which;32!==o&&13!==o||("up"!==w&&(F(),M()),t.preventDefault())}),p.up.on("keyup.touchspin",function(t){t=t.keyCode||t.which;32!==t&&13!==t||P()}),p.down.on("mousedown.touchspin",function(t){p.down.off("touchstart.touchspin"),m.is(":disabled,[readonly]")||(j(),D(),t.preventDefault(),t.stopPropagation())}),p.down.on("touchstart.touchspin",function(t){p.down.off("mousedown.touchspin"),m.is(":disabled,[readonly]")||(j(),D(),t.preventDefault(),t.stopPropagation())}),p.up.on("mousedown.touchspin",function(t){p.up.off("touchstart.touchspin"),m.is(":disabled,[readonly]")||(F(),M(),t.preventDefault(),t.stopPropagation())}),p.up.on("touchstart.touchspin",function(t){p.up.off("mousedown.touchspin"),m.is(":disabled,[readonly]")||(F(),M(),t.preventDefault(),t.stopPropagation())}),p.up.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(t){w&&(t.stopPropagation(),P())}),p.down.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(t){w&&(t.stopPropagation(),P())}),p.down.on("mousemove.touchspin touchmove.touchspin",function(t){w&&(t.stopPropagation(),t.preventDefault())}),p.up.on("mousemove.touchspin touchmove.touchspin",function(t){w&&(t.stopPropagation(),t.preventDefault())}),m.on("mousewheel.touchspin DOMMouseScroll.touchspin",function(t){var o;s.mousewheel&&m.is(":focus")&&(o=t.originalEvent.wheelDelta||-t.originalEvent.deltaY||-t.originalEvent.detail,t.stopPropagation(),t.preventDefault(),(o<0?j:F)())}),m.on("touchspin.destroy",function(){var t=m.parent();P(),m.off(".touchspin"),t.hasClass("bootstrap-touchspin-injected")?(m.siblings().remove(),m.unwrap()):(S(".bootstrap-touchspin-injected",t).remove(),t.removeClass("bootstrap-touchspin")),m.data("alreadyinitialized",!1)}),m.on("touchspin.uponce",function(){P(),F()}),m.on("touchspin.downonce",function(){P(),j()}),m.on("touchspin.startupspin",function(){M()}),m.on("touchspin.startdownspin",function(){D()}),m.on("touchspin.stopspin",function(){P()}),m.on("touchspin.updatesettings",function(t,o){var n=o;s=S.extend({},s,n),n.postfix&&(0===m.parent().find(".bootstrap-touchspin-postfix").length&&e.insertAfter(m),m.parent().find(".bootstrap-touchspin-postfix .input-group-text").text(n.postfix)),n.prefix&&(0===m.parent().find(".bootstrap-touchspin-prefix").length&&a.insertBefore(m),m.parent().find(".bootstrap-touchspin-prefix .input-group-text").text(n.prefix)),y(),_(),""!==(o=p.input.val())&&(o=parseFloat(s.callback_before_calculation(p.input.val())),p.input.val(s.callback_after_calculation(parseFloat(o).toFixed(s.decimals))))})):console.log("Must be an input."))})}});