/*
 *  Bootstrap Touchspin - v4.5.1
 *  A mobile and touch friendly input spinner component for Bootstrap 3 & 4.
 *  https://www.virtuosoft.eu/code/bootstrap-touchspin/
 *
 *  Made by István Ujj-Mészáros
 *  Under Apache License v2.0 License
 */
!function(o){"function"==typeof define&&define.amd?define(["jquery"],o):"object"==typeof module&&module.exports?module.exports=function(t,n){return void 0===n&&(n="undefined"!=typeof window?require("jquery"):require("jquery")(t)),o(n),n}:o(jQuery)}(function(q){"use strict";var S=0;q.fn.TouchSpin=function(M){var P={min:0,max:100,initval:"",replacementval:"",firstclickvalueifempty:null,step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalup:"+",verticaldown:"-",verticalupclass:"",verticaldownclass:"",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-primary",buttonup_class:"btn btn-primary",buttondown_txt:"-",buttonup_txt:"+",callback_before_calculation:function(t){return t},callback_after_calculation:function(t){return t}},N={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",firstclickvalueifempty:"first-click-value-if-empty",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){var s,a,e,p,o,t,n,i,u,r,c,l,d,f,b,h=q(this),v=h.data(),x=0,g=!1;function m(){""===s.prefix&&(a=p.prefix.detach()),""===s.postfix&&(e=p.postfix.detach())}function w(){var t,n,o=s.callback_before_calculation(h.val());""===o?""!==s.replacementval&&(h.val(s.replacementval),h.trigger("change")):0<s.decimals&&"."===o||(t=parseFloat(o),(n=t=isNaN(t)?""!==s.replacementval?s.replacementval:0:t).toString()!==o&&(n=t),null!==s.min&&t<s.min&&(n=s.min),null!==s.max&&t>s.max&&(n=s.max),parseFloat(o).toString()!==n.toString()&&(h.val(n),h.trigger("change")))}function y(){var t;return s.booster?(t=Math.pow(2,Math.floor(x/s.boostat))*s.step,s.maxboostedstep&&t>s.maxboostedstep&&(t=s.maxboostedstep,o=Math.round(o/t)*t),Math.max(s.step,t)):s.step}function _(){return"number"==typeof s.firstclickvalueifempty?s.firstclickvalueifempty:(s.min+s.max)/2}function k(){w();var t,n=o=parseFloat(s.callback_before_calculation(p.input.val()));isNaN(o)?o=_():(t=y(),o+=t),null!==s.max&&o>s.max&&(o=s.max,h.trigger("touchspin.on.max"),D()),p.input.val(s.callback_after_calculation(parseFloat(o).toFixed(s.decimals))),n!==o&&h.trigger("change")}function C(){w();var t,n=o=parseFloat(s.callback_before_calculation(p.input.val()));isNaN(o)?o=_():(t=y(),o-=t),null!==s.min&&o<s.min&&(o=s.min,h.trigger("touchspin.on.min"),D()),p.input.val(s.callback_after_calculation(parseFloat(o).toFixed(s.decimals))),n!==o&&h.trigger("change")}function F(){D(),x=0,g="down",h.trigger("touchspin.on.startspin"),h.trigger("touchspin.on.startdownspin"),i=setTimeout(function(){t=setInterval(function(){x++,C()},s.stepinterval)},s.stepintervaldelay)}function j(){D(),x=0,g="up",h.trigger("touchspin.on.startspin"),h.trigger("touchspin.on.startupspin"),u=setTimeout(function(){n=setInterval(function(){x++,k()},s.stepinterval)},s.stepintervaldelay)}function D(){switch(clearTimeout(i),clearTimeout(u),clearInterval(t),clearInterval(n),g){case"up":h.trigger("touchspin.on.stopupspin"),h.trigger("touchspin.on.stopspin");break;case"down":h.trigger("touchspin.on.stopdownspin"),h.trigger("touchspin.on.stopspin")}x=0,g=!1}h.data("alreadyinitialized")||(h.data("alreadyinitialized",!0),S+=1,h.data("spinnerid",S),h.is("input")?(""!==(s=q.extend({},P,v,function(){var o={};return q.each(N,function(t,n){n="bts-"+n;h.is("[data-"+n+"]")&&(o[t]=h.data(n))}),o}(),M)).initval&&""===h.val()&&h.val(s.initval),w(),v=h.val(),b=h.parent(),""!==v&&(v=s.callback_after_calculation(parseFloat(v).toFixed(s.decimals))),h.data("initvalue",v).val(v),h.addClass("form-control"),b.hasClass("input-group")?((v=b).addClass("bootstrap-touchspin"),b=h.prev(),l=h.next(),d='<span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix input-group-prepend bootstrap-touchspin-injected"><span class="input-group-text">'+s.prefix+"</span></span>",f='<span class="input-group-addon input-group-append bootstrap-touchspin-postfix input-group-append bootstrap-touchspin-injected"><span class="input-group-text">'+s.postfix+"</span></span>",b.hasClass("input-group-btn")||b.hasClass("input-group-prepend")?(r='<button class="'+s.buttondown_class+' bootstrap-touchspin-down bootstrap-touchspin-injected" type="button">'+s.buttondown_txt+"</button>",b.append(r)):(r='<span class="input-group-btn input-group-prepend bootstrap-touchspin-injected"><button class="'+s.buttondown_class+' bootstrap-touchspin-down" type="button">'+s.buttondown_txt+"</button></span>",q(r).insertBefore(h)),l.hasClass("input-group-btn")||l.hasClass("input-group-append")?(c='<button class="'+s.buttonup_class+' bootstrap-touchspin-up bootstrap-touchspin-injected" type="button">'+s.buttonup_txt+"</button>",l.prepend(c)):(c='<span class="input-group-btn input-group-append bootstrap-touchspin-injected"><button class="'+s.buttonup_class+' bootstrap-touchspin-up" type="button">'+s.buttonup_txt+"</button></span>",q(c).insertAfter(h)),q(d).insertBefore(h),q(f).insertAfter(h),r=v):(b="",h.hasClass("input-sm")&&(b="input-group-sm"),h.hasClass("input-lg")&&(b="input-group-lg"),b=s.verticalbuttons?'<div class="input-group '+b+' bootstrap-touchspin bootstrap-touchspin-injected"><span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix"><span class="input-group-text">'+s.prefix+'</span></span><span class="input-group-addon bootstrap-touchspin-postfix input-group-append"><span class="input-group-text">'+s.postfix+'</span></span><span class="input-group-btn-vertical"><button class="'+s.buttondown_class+" bootstrap-touchspin-up "+s.verticalupclass+'" type="button">'+s.verticalup+'</button><button class="'+s.buttonup_class+" bootstrap-touchspin-down "+s.verticaldownclass+'" type="button">'+s.verticaldown+"</button></span></div>":'<div class="input-group bootstrap-touchspin bootstrap-touchspin-injected"><span class="input-group-btn input-group-prepend"><button class="'+s.buttondown_class+' bootstrap-touchspin-down" type="button">'+s.buttondown_txt+'</button></span><span class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"><span class="input-group-text">'+s.prefix+'</span></span><span class="input-group-addon bootstrap-touchspin-postfix input-group-append"><span class="input-group-text">'+s.postfix+'</span></span><span class="input-group-btn input-group-append"><button class="'+s.buttonup_class+' bootstrap-touchspin-up" type="button">'+s.buttonup_txt+"</button></span></div>",r=q(b).insertBefore(h),q(".bootstrap-touchspin-prefix",r).after(h),h.hasClass("input-sm")?r.addClass("input-group-sm"):h.hasClass("input-lg")&&r.addClass("input-group-lg")),p={down:q(".bootstrap-touchspin-down",r),up:q(".bootstrap-touchspin-up",r),input:q("input",r),prefix:q(".bootstrap-touchspin-prefix",r).addClass(s.prefix_extraclass),postfix:q(".bootstrap-touchspin-postfix",r).addClass(s.postfix_extraclass)},m(),"undefined"!=typeof MutationObserver&&new MutationObserver(t=>{t.forEach(t=>{"attributes"!==t.type||"disabled"!==t.attributeName&&"readonly"!==t.attributeName||(t=h.is(":disabled,[readonly]"),p.up.prop("disabled",t),p.down.prop("disabled",t))})}).observe(h[0],{attributes:!0}),h.on("keydown.touchspin",function(t){var n=t.keyCode||t.which;38===n?("up"!==g&&(k(),j()),t.preventDefault()):40===n?("down"!==g&&(C(),F()),t.preventDefault()):9!==n&&13!==n||h.val(function(t){switch(s.forcestepdivisibility){case"round":return(Math.round(t/s.step)*s.step).toFixed(s.decimals);case"floor":return(Math.floor(t/s.step)*s.step).toFixed(s.decimals);case"ceil":return(Math.ceil(t/s.step)*s.step).toFixed(s.decimals);default:return t.toFixed(s.decimals)}}(h.val()))}),h.on("keyup.touchspin",function(t){t=t.keyCode||t.which;38!==t&&40!==t||D()}),h.on("blur.touchspin",function(){w(),h.val(s.callback_after_calculation(h.val()))}),p.down.on("keydown",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||("down"!==g&&(C(),F()),t.preventDefault())}),p.down.on("keyup.touchspin",function(t){t=t.keyCode||t.which;32!==t&&13!==t||D()}),p.up.on("keydown.touchspin",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||("up"!==g&&(k(),j()),t.preventDefault())}),p.up.on("keyup.touchspin",function(t){t=t.keyCode||t.which;32!==t&&13!==t||D()}),p.down.on("mousedown.touchspin",function(t){p.down.off("touchstart.touchspin"),h.is(":disabled,[readonly]")||(C(),F(),t.preventDefault(),t.stopPropagation())}),p.down.on("touchstart.touchspin",function(t){p.down.off("mousedown.touchspin"),h.is(":disabled,[readonly]")||(C(),F(),t.preventDefault(),t.stopPropagation())}),p.up.on("mousedown.touchspin",function(t){p.up.off("touchstart.touchspin"),h.is(":disabled,[readonly]")||(k(),j(),t.preventDefault(),t.stopPropagation())}),p.up.on("touchstart.touchspin",function(t){p.up.off("mousedown.touchspin"),h.is(":disabled,[readonly]")||(k(),j(),t.preventDefault(),t.stopPropagation())}),p.up.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(t){g&&(t.stopPropagation(),D())}),p.down.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(t){g&&(t.stopPropagation(),D())}),p.down.on("mousemove.touchspin touchmove.touchspin",function(t){g&&(t.stopPropagation(),t.preventDefault())}),p.up.on("mousemove.touchspin touchmove.touchspin",function(t){g&&(t.stopPropagation(),t.preventDefault())}),h.on("mousewheel.touchspin DOMMouseScroll.touchspin",function(t){var n;s.mousewheel&&h.is(":focus")&&(n=t.originalEvent.wheelDelta||-t.originalEvent.deltaY||-t.originalEvent.detail,t.stopPropagation(),t.preventDefault(),(n<0?C:k)())}),h.on("touchspin.destroy",function(){var t=h.parent();D(),h.off(".touchspin"),t.hasClass("bootstrap-touchspin-injected")?(h.siblings().remove(),h.unwrap()):(q(".bootstrap-touchspin-injected",t).remove(),t.removeClass("bootstrap-touchspin")),h.data("alreadyinitialized",!1)}),h.on("touchspin.uponce",function(){D(),k()}),h.on("touchspin.downonce",function(){D(),C()}),h.on("touchspin.startupspin",function(){j()}),h.on("touchspin.startdownspin",function(){F()}),h.on("touchspin.stopspin",function(){D()}),h.on("touchspin.updatesettings",function(t,n){var o=n;s=q.extend({},s,o),o.postfix&&(0===h.parent().find(".bootstrap-touchspin-postfix").length&&e.insertAfter(h),h.parent().find(".bootstrap-touchspin-postfix .input-group-text").text(o.postfix)),o.prefix&&(0===h.parent().find(".bootstrap-touchspin-prefix").length&&a.insertBefore(h),h.parent().find(".bootstrap-touchspin-prefix .input-group-text").text(o.prefix)),m(),w(),""!==(n=p.input.val())&&(n=parseFloat(s.callback_before_calculation(p.input.val())),p.input.val(s.callback_after_calculation(parseFloat(n).toFixed(s.decimals))))})):console.log("Must be an input."))})}});